#include "trapz.h"

double catools_trapz(int n, double *x, double *y)
{
    // computes the integral of y with respect to x using trapezoidal integration.

    double output = 0.0;
    for (int i = 1; i < n; i++)
        output += (x[i] - x[i - 1]) * (y[i] + y[i - 1]);

    return output / 2.0;
}

// int main(int argc, char **argv)
// {
//     double x[10] = {
//         1485471600.000000000000,
//         1485471600.009999990463,
//         1485471600.019999980927,
//         1485471600.029999971390,
//         1485471600.039999961853,
//         1485471600.049999952316,
//         1485471600.059999942780,
//         1485471600.069999933243,
//         1485471600.079999923706,
//         1485471600.089999914169};
//     double y[10] = {
//         0.0002788192983800714930785,
//         0.0022849829501989859723010,
//         0.0092785855527874171871927,
//         0.0255019526341984242856498,
//         0.0544881244214454121821412,
//         0.0978768754327602324982749,
//         0.1550487113677821160440118,
//         0.2233115986951992593123606,
//         0.2984191642305147884606242,
//         0.3752430519378844309130727};

//     // 0.01053969925758011828842
//     double output = catools_trapz(10, x, y);
//     return 0;
// }
